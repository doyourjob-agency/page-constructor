"use strict";(self.webpackChunk_doyourjob_gravity_ui_page_constructor=self.webpackChunk_doyourjob_gravity_ui_page_constructor||[]).push([[694],{"./src/components/YandexForm/YandexForm.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{ZP:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_context_localeContext__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./src/context/localeContext/localeContext.ts"),_context_mobileContext__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/context/mobileContext/MobileContext.ts"),_hooks__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/hooks/useAnalytics.ts"),_models_common__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/models/common.ts"),_utils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/utils/cn.ts"),_constants__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/components/constants.ts");const CONTAINER_ID="pc-yandex-form-container",b=(0,_utils__WEBPACK_IMPORTED_MODULE_1__.Ge)("yandex-form"),YandexForm=props=>{const{onLoad,id,params,className,theme,containerId=CONTAINER_ID,headerHeight=_constants__WEBPACK_IMPORTED_MODULE_2__.Mz,onSubmit,analyticsEvents,customFormOrigin,customFormSection}=props,formContainerRef=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null),iframeRef=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(),yaFormOrigin=customFormOrigin||"https://forms.yandex.ru",yaFormSection=customFormSection||"surveys",handleAnalytics=(0,_hooks__WEBPACK_IMPORTED_MODULE_3__.z)(_models_common__WEBPACK_IMPORTED_MODULE_4__.IZ.YandexFormSubmit),isMobile=(0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_context_mobileContext__WEBPACK_IMPORTED_MODULE_5__.z),locale=(0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_context_localeContext__WEBPACK_IMPORTED_MODULE_6__.R),updateFormIframe=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((container=>{const queryParams=new URLSearchParams(location.search),url=location.origin+location.pathname;queryParams.set("url",url),queryParams.set("iframe","1"),locale?.lang&&queryParams.set("lang",locale.lang),queryParams.set("theme",theme||"cloud-www"),isMobile&&queryParams.set("media-type","mobile"),params&&Object.keys(params).forEach((param=>{queryParams.set(param,params[param])}));const src=`${yaFormOrigin}/${yaFormSection}/${id}/?${queryParams}`;iframeRef.current?iframeRef.current.src=src:(iframeRef.current=document.createElement("iframe"),iframeRef.current.src=src,iframeRef.current.id=containerId,iframeRef.current.name=`form${id}`,iframeRef.current.setAttribute("loading","lazy"),iframeRef.current.frameBorder="0",iframeRef.current.scrolling="no",iframeRef.current.width="100%",container.appendChild(iframeRef.current))}),[locale.lang,theme,isMobile,yaFormOrigin,yaFormSection,id,containerId,params]),handleSubmit=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((()=>{if(formContainerRef&&formContainerRef.current){const{top}=formContainerRef.current.getBoundingClientRect();window.scrollBy(0,top-headerHeight)}handleAnalytics(analyticsEvents),onSubmit&&onSubmit()}),[handleAnalytics,analyticsEvents,onSubmit,headerHeight]),handleMessage=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((({origin,data})=>{if(origin===yaFormOrigin)try{const parsed=JSON.parse(data),height=parsed["iframe-height"],{message,name,redirectUrl}=parsed;if(name!==`form${id}`)return;iframeRef.current&&height&&!message&&(iframeRef.current.height=`${height}px`,onLoad?.()),("sent"===message||redirectUrl)&&handleSubmit()}catch(error){return}}),[yaFormOrigin,id,onLoad,handleSubmit]),addIframe=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((()=>{const container=formContainerRef.current;container&&(updateFormIframe(container),window.addEventListener("message",handleMessage,{passive:!0}))}),[updateFormIframe,handleMessage]);return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>(addIframe(),setTimeout((()=>onLoad?.()),1e3),()=>window.removeEventListener("message",handleMessage))),[id,addIframe,handleMessage,onLoad]),react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{ref:formContainerRef,className:b(null,className)})},__WEBPACK_DEFAULT_EXPORT__=YandexForm;YandexForm.__docgenInfo={description:"",methods:[],displayName:"YandexForm",props:{analyticsEvents:{required:!1,tsType:{name:"union",raw:"AnalyticsEvent | AnalyticsEvent[]",elements:[{name:"intersection",raw:"T & {\n    name: string;\n    type?: string;\n    counters?: AnalyticsCounters;\n    context?: string;\n    target?: string;\n}",elements:[{name:"T"},{name:"signature",type:"object",raw:"{\n    name: string;\n    type?: string;\n    counters?: AnalyticsCounters;\n    context?: string;\n    target?: string;\n}",signature:{properties:[{key:"name",value:{name:"string",required:!0}},{key:"type",value:{name:"string",required:!1}},{key:"counters",value:{name:"signature",type:"object",raw:"{\n    include?: string[];\n    exclude?: string[];\n}",signature:{properties:[{key:"include",value:{name:"Array",elements:[{name:"string"}],raw:"string[]",required:!1}},{key:"exclude",value:{name:"Array",elements:[{name:"string"}],raw:"string[]",required:!1}}]},required:!1}},{key:"context",value:{name:"string",required:!1}},{key:"target",value:{name:"string",required:!1}}]}}]},{name:"Array",elements:[{name:"intersection",raw:"T & {\n    name: string;\n    type?: string;\n    counters?: AnalyticsCounters;\n    context?: string;\n    target?: string;\n}",elements:[{name:"T"},{name:"signature",type:"object",raw:"{\n    name: string;\n    type?: string;\n    counters?: AnalyticsCounters;\n    context?: string;\n    target?: string;\n}",signature:{properties:[{key:"name",value:{name:"string",required:!0}},{key:"type",value:{name:"string",required:!1}},{key:"counters",value:{name:"signature",type:"object",raw:"{\n    include?: string[];\n    exclude?: string[];\n}",signature:{properties:[{key:"include",value:{name:"Array",elements:[{name:"string"}],raw:"string[]",required:!1}},{key:"exclude",value:{name:"Array",elements:[{name:"string"}],raw:"string[]",required:!1}}]},required:!1}},{key:"context",value:{name:"string",required:!1}},{key:"target",value:{name:"string",required:!1}}]}}]}],raw:"AnalyticsEvent[]"}]},description:""},id:{required:!0,tsType:{name:"union",raw:"number | string",elements:[{name:"number"},{name:"string"}]},description:""},containerId:{required:!1,tsType:{name:"string"},description:""},theme:{required:!1,tsType:{name:"string"},description:""},className:{required:!1,tsType:{name:"string"},description:""},headerHeight:{required:!1,tsType:{name:"number"},description:""},customFormOrigin:{required:!1,tsType:{name:"string"},description:""},customFormSection:{required:!1,tsType:{name:"string"},description:""},params:{required:!1,tsType:{name:"signature",type:"object",raw:"{[key: string]: string}",signature:{properties:[{key:{name:"string"},value:{name:"string",required:!0}}]}},description:""},onSubmit:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onLoad:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}}},"./src/context/blockIdContext/blockIdContext.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{N:()=>BlockIdContext});const BlockIdContext=__webpack_require__("./node_modules/react/index.js").createContext("")},"./src/hooks/useAnalytics.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{z:()=>useAnalytics});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_context_analyticsContext__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/context/analyticsContext/analyticsContext.tsx"),_context_blockIdContext__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/context/blockIdContext/blockIdContext.ts"),_models__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/models/common.ts");const useAnalytics=(name="",target)=>{const{sendEvents,autoEvents}=(0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_context_analyticsContext__WEBPACK_IMPORTED_MODULE_1__.f),context=(0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_context_blockIdContext__WEBPACK_IMPORTED_MODULE_2__.N),defaultEvent=(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)((()=>name?{name,context,type:_models__WEBPACK_IMPORTED_MODULE_3__.hD.Default,target}:void 0),[context,name,target]);if(!sendEvents)return()=>{};const defaultEvents=defaultEvent&&autoEvents?[defaultEvent]:[];return(e,additionalContext)=>{let events=defaultEvents;if(e&&(events=Array.isArray(e)?[...events,...e]:[...events,e]),!events)return;const preparedEvents=additionalContext?events.map((event=>({...event,...additionalContext}))):events;sendEvents(preparedEvents)}}},"./src/components/YandexForm/__stories__/YandexForm.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>YandexForm_stories});var react=__webpack_require__("./node_modules/react/index.js"),YandexForm=__webpack_require__("./src/components/YandexForm/YandexForm.tsx");const data_namespaceObject=JSON.parse('{"Z":{"k":{"id":"61a4e639d4d24e0dbba36f5c","customFormSection":"cloud"}}}'),YandexForm_stories={component:YandexForm.ZP,title:"Components/YandexForm",argTypes:{id:{control:{type:"text"}}}},Default=(args=>react.createElement(YandexForm.ZP,args)).bind({});Default.args=data_namespaceObject.Z.k;const __namedExportsOrder=["Default"];Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"args => <YandexForm {...args} />",...Default.parameters?.docs?.source}}}}}]);